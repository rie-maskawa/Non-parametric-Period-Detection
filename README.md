# Non-Parametric Period Detection (NNPD)

This repository provides a complete workflow for extracting oscillatory structure from high-frequency microbiome time-series data using **Non-Parametric Period Detection (NNPD)** and downstream **phase-based clustering and synchronization analysis**.

The workflow is designed for genome-resolved microbiome datasets but is applicable to any uneven, noisy, or nonstationary biological time-series.

---

## Repository Structure
```
Non-parametric-Period-Detection/
│
├── notebooks/
│   ├── NNPD.ipynb              # Detect oscillatory cycles and estimate phase trajectories
│   └── Phase_analysis.ipynb    # Cluster genomes by phase and compute synchronization metrics
│
├── data/
│   └── MAG_TSS_test.csv        # Example MAG abundance data (TSS-normalized)
│
└── input_for_PhaseAnalysis/
    └── MAG_test_summary.csv    # Example summary table for downstream phase clustering
│
└── LICENSE
│
└── README.md
```
---

## Workflow Overview

### 1. Detect oscillatory cycles and compute phases (NNPD)
**Notebook:** `notebooks/NNPD.ipynb`

NNPD is a **non-parametric, data-driven algorithm** that:

- detects statistically significant increasing/decreasing segments  
- reconstructs oscillatory cycles  
- assigns continuous phase trajectories θ(t)  
- handles missing values, irregular sampling, and nonstationary signals  
- requires no sinusoidal or parametric assumptions  

**Output:**

- `MAG_test_phase.csv` — a phase matrix where rows are MAGs and columns are time points

---

### 2. Phase-based clustering and synchronization analysis
**Notebook:** `notebooks/Phase_analysis.ipynb`

This notebook performs:

#### (a) Phase-distance calculation  
Based on circular statistics and PLV-derived metrics.

#### (b) Hierarchical clustering  
Identifies coherent phase clusters (e.g., light-phase / dark-phase groups).

#### (c) Synchronization analysis  
Computes the **order parameter** for each cluster:

\[
z_c(t) = R_c(t)e^{i\phi_c(t)}
\]

Where:

- **R_c(t)** = phase coherence (0 = dispersed, 1 = synchronized)  
- **φ_c(t)** = mean phase of the cluster  

**Outputs:**

- cluster labels for each MAG  
- time-resolved order parameters R_c(t) and mean phases φ_c(t)

---

## Input Files

### `data/MAG_TSS_test.csv`
Example normalized MAG-abundance matrix:

- rows = MAGs  
- columns = time points  
- values = TSS-normalized abundance  

Used as input for NNPD.

### `input_for_PhaseAnalysis/MAG_test_phase.csv`
Example phase matrix generated by NNPD.

---
